# Autoformer: Decomposition Transformers with Auto-Correlation for Long-Term Series Forecasting 


#### Abstract

Extending the forecasting time is a critical demand for real applications, such as extreme weather early warning and long-term energy consumption planning. This paper studies the long-term forecasting problem of time series. Prior Transformerbased models adopt various self-attention mechanisms to discover the long-range dependencies. However, intricate temporal patterns of the long-term future prohibit the model from finding reliable dependencies. Also, Transformers have to adopt the sparse versions of point-wise self-attentions for long series efficiency, resulting in the information utilization bottleneck. Going beyond Transformers, we design Autoformer as a novel decomposition architecture with an Auto-Correlation mechanism. We break with the pre-processing convention of series decomposition and renovate it as a basic inner block of deep models. This design empowers Autoformer with progressive decomposition capacities for complex time series. Further, inspired by the stochastic process theory, we design the Auto-Correlation mechanism based on the series periodicity, which conducts the dependencies discovery and representation aggregation at the sub-series level. Auto-Correlation outperforms self-attention in both efficiency and accuracy. In long-term forecasting, Autoformer yields state-of-the-art accuracy, with a $38 \%$ relative improvement on six benchmarks, covering five practical applications: energy, traffic, economics, weather and disease. Code is available at this repository: https://github.com/thuml/Autoformer.


## 1 Introduction

Time series forecasting has been widely used in energy consumption, traffic and economics planning, weather and disease propagation forecasting. In these real-world applications, one pressing demand is to extend the forecast time into the far future, which is quite meaningful for the long-term planning and early warning. Thus, in this paper, we study the long-term forecasting problem of time series, characterizing itself by the large length of predicted time series. Recent deep forecasting models $[48,23,26,34,29,35,25,41]$ have achieved great progress, especially the Transformer-based models. Benefiting from the self-attention mechanism, Transformers obtain great advantage in modeling long-term dependencies for sequential data, which enables more powerful big models [8, 13].

---

However, the forecasting task is extremely challenging under the long-term setting. First, it is unreliable to discover the temporal dependencies directly from the long-term time series because the dependencies can be obscured by entangled temporal patterns. Second, canonical Transformers with self-attention mechanisms are computationally prohibitive for long-term forecasting because of the quadratic complexity of sequence length. Previous Transformer-based forecasting models [48, 23, 26] mainly focus on improving self-attention to a sparse version. While performance is significantly improved, these models still utilize the point-wise representation aggregation. Thus, in the process of efficiency improvement, they will sacrifice the information utilization because of the sparse point-wise connections, resulting in a bottleneck for long-term forecasting of time series.

---

To reason about the intricate temporal patterns, we try to take the idea of decomposition, which is a standard method in time series analysis [1, 33]. It can be used to process the complex time series and extract more predictable components. However, under the forecasting context, it can only be used as the pre-processing of past series because the future is unknown [20]. This common usage limits the capabilities of decomposition and overlooks the potential future interactions among decomposed components. Thus, we attempt to go beyond pre-processing usage of decomposition and propose a generic architecture to empower the deep forecasting models with immanent capacity of progressive decomposition. Further, decomposition can ravel out the entangled temporal patterns and highlight the inherent properties of time series [20]. Benefiting from this, we try to take advantage of the series periodicity to renovate the point-wise connection in self-attention. We observe that the sub-series at the same phase position among periods often present similar temporal processes. Thus, we try to construct a series-level connection based on the process similarity derived by series periodicity.

---

Based on the above motivations, we propose an original Autoformer in place of the Transformers for long-term time series forecasting. Autoformer still follows residual and encoder-decoder structure but renovates Transformer into a decomposition forecasting architecture. By embedding our proposed decomposition blocks as the inner operators, Autoformer can progressively separate the long-term trend information from predicted hidden variables. This design allows our model to alternately decompose and refine the intermediate results during the forecasting procedure. Inspired by the stochastic process theory [9, 30], Autoformer introduces an Auto-Correlation mechanism in place of self-attention, which discovers the sub-series similarity based on the series periodicity and aggregates similar sub-series from underlying periods. This series-wise mechanism achieves $\mathcal{O}(L \log L)$ complexity for length- $L$ series and breaks the information utilization bottleneck by expanding the point-wise representation aggregation to sub-series level. Autoformer achieves the state-of-the-art accuracy on six benchmarks. The contributions are summarized as follows:

- To tackle the intricate temporal patterns of the long-term future, we present Autoformer as a decomposition architecture and design the inner decomposition block to empower the deep forecasting model with immanent progressive decomposition capacity.
- We propose an Auto-Correlation mechanism with dependencies discovery and information aggregation at the series level. Our mechanism is beyond previous self-attention family and can simultaneously benefit the computation efficiency and information utilization.
- Autoformer achieves a $38 \%$ relative improvement under the long-term setting on six benchmarks, covering five real-world applications: energy, traffic, economics, weather and disease.


## 2 Related Work

### 2.1 Models for Time Series Forecasting

Due to the immense importance of time series forecasting, various models have been well developed. Many time series forecasting methods start from the classic tools [38, 10]. ARIMA [7, 6] tackles the forecasting problem by transforming the non-stationary process to stationary through differencing. The filtering method is also introduced for series forecasting [24, 12]. Besides, recurrent neural networks (RNNs) models are used to model the temporal dependencies for time series [42, 32, 47, 28]. DeepAR [34] combines autoregressive methods and RNNs to model the probabilistic distribution of future series. LSTNet [25] introduces convolutional neural networks (CNNs) with recurrent-skip connections to capture the short-term and long-term temporal patterns. Attention-based RNNs [46, 36, 37] introduce the temporal attention to explore the long-range dependencies for prediction. Also, many works based on temporal convolution networks (TCN) [40, 5, 4, 35] attempt to model the temporal causality with the causal convolution. These deep forecasting models mainly focus on the temporal relation modeling by recurrent connections, temporal attention or causal convolution.

---

Recently, Transformers [41, 45] based on the self-attention mechanism shows great power in sequential data, such as natural language processing [13, 8], audio processing [19] and even computer vision [16, 27]. However, applying self-attention to long-term time series forecasting is computationally prohibitive because of the quadratic complexity of sequence length $L$ in both memory and time. LogTrans [26] introduces the local convolution to Transformer and proposes the LogSparse attention to select time steps following the exponentially increasing intervals, which reduces the complexity to $\mathcal{O}\left(L(\log L)^{2}\right)$. Reformer [23] presents the local-sensitive hashing (LSH) attention and reduces the complexity to $\mathcal{O}(L \log L)$. Informer [48] extends Transformer with KL-divergence based ProbSparse attention and also achieves $\mathcal{O}(L \log L)$ complexity. Note that these methods are based on the vanilla Transformer and try to improve the self-attention mechanism to a sparse version, which still follows the point-wise dependency and aggregation. In this paper, our proposed Auto-Correlation mechanism is based on the inherent periodicity of time series and can provide series-wise connections.

### 2.2 Decomposition of Time Series

As a standard method in time series analysis, time series decomposition [1, 33] deconstructs a time series into several components, each representing one of the underlying categories of patterns that are more predictable. It is primarily useful for exploring historical changes over time. For the forecasting tasks, decomposition is always used as the pre-processing of historical series before predicting future series [20, 2], such as Prophet [39] with trend-seasonality decomposition and N-BEATS [29] with basis expansion and DeepGLO [35] with matrix decomposition. However, such pre-processing is limited by the plain decomposition effect of historical series and overlooks the hierarchical interaction between the underlying patterns of series in the long-term future. This paper takes the decomposition idea from a new progressive dimension. Our Autoformer harnesses the decomposition as an inner block of deep models, which can progressively decompose the hidden series throughout the whole forecasting process, including both the past series and the predicted intermediate results.

## 3 Autoformer

The time series forecasting problem is to predict the most probable length- $O$ series in the future given the past length- $I$ series, denoting as input-I-predict- $O$. The long-term forecasting setting is to predict the long-term future, i.e. larger $O$. As aforementioned, we have highlighted the difficulties of long-term series forecasting: handling intricate temporal patterns and breaking the bottleneck of computation efficiency and information utilization. To tackle these two challenges, we introduce the decomposition as a builtin block to the deep forecasting model and propose Autoformer as a decomposition architecture. Besides, we design the Auto-Correlation mechanism to discover the period-based dependencies and aggregate similar sub-series from underlying periods.

### 3.1 Decomposition Architecture

We renovate Transformer [41] to a deep decomposition architecture (Figure 1), including the inner series decomposition block, Auto-Correlation mechanism, and corresponding Encoder and Decoder.

Series decomposition block To learn with the complex temporal patterns in long-term forecasting context, we take the idea of decomposition [1, 33], which can separate the series into trend-cyclical and seasonal parts. These two parts reflect the long-term progression and the seasonality of the series respectively. However, directly decomposing is unrealizable for future series because the future is just unknown. To tackle this dilemma, we present a series decomposition block as an inner operation of Autoformer (Figure 1), which can extract the long-term stationary trend from predicted intermediate hidden variables progressively. Concretely, we adapt the moving average to smooth out periodic fluctuations and highlight the long-term trends. For length- $L$ input series $\mathcal{X} \in \mathbb{R}^{L \times d}$, the process is:

$$
\begin{align*}
& \mathcal{X}_{\mathrm{t}}=\operatorname{AvgPool}(\operatorname{Padding}(\mathcal{X}))  \tag{1}\\
& \mathcal{X}_{\mathrm{s}}=\mathcal{X}-\mathcal{X}_{\mathrm{t}}
\end{align*}
$$

where $\mathcal{X}_{\mathrm{s}}, \mathcal{X}_{\mathrm{t}} \in \mathbb{R}^{L \times d}$ denote the seasonal and the extracted trend-cyclical part respectively. We adopt the $\operatorname{Avg} \operatorname{Pool}(\cdot)$ for moving average with the padding operation to keep the series length unchanged. We use $\mathcal{X}_{\mathrm{s}}, \mathcal{X}_{\mathrm{t}}=\operatorname{SeriesDecomp}(\mathcal{X})$ to summarize above equations, which is a model inner block.

---

Model inputs The inputs of encoder part are the past $I$ time steps $\mathcal{X}_{\text {en }} \in \mathbb{R}^{I \times d}$. As a decomposition architecture (Figure 11), the input of Autoformer decoder contains both the seasonal part $\mathcal{X}_{\text {des }} \in$ $\mathbb{R}^{\left(\frac{I}{2}+O\right) \times d}$ and trend-cyclical part $\mathcal{X}_{\text {det }} \in \mathbb{R}^{\left(\frac{I}{2}+O\right) \times d}$ to be refined. Each initialization consists of two parts: the component decomposed from the latter half of encoder's input $\mathcal{X}_{\text {en }}$ with length $\frac{I}{2}$ to provide recent information, placeholders with length $O$ filled by scalars. It's formulized as follows:

$$
\begin{align*}
\mathcal{X}_{\text {ens }}, \mathcal{X}_{\text {ent }} & =\operatorname{SeriesDecomp}\left(\mathcal{X}_{\text {en }} \frac{I}{2}: I\right. \\
\mathcal{X}_{\text {des }} & =\operatorname{Concat}\left(\mathcal{X}_{\text {ens }}, \mathcal{X}_{0}\right)  \tag{2}\\
\mathcal{X}_{\text {det }} & =\operatorname{Concat}\left(\mathcal{X}_{\text {ent }}, \mathcal{X}_{\text {Mean }}\right),
\end{align*}
$$


where $\mathcal{X}_{\text {ens }}, \mathcal{X}_{\text {ent }} \in \mathbb{R}^{\frac{I}{2} \times d}$ denote the seasonal and trend-cyclical parts of $\mathcal{X}_{\text {en }}$ respectively, and $\mathcal{X}_{0}, \mathcal{X}_{\text {Mean }} \in \mathbb{R}^{O \times d}$ denote the placeholders filled with zero and the mean of $\mathcal{X}_{\text {en }}$ respectively.

---

Encoder As shown in Figure 1, the encoder focuses on the seasonal part modeling. The output of the encoder contains the past seasonal information and will be used as the cross information to help the decoder refine prediction results. Suppose we have $N$ encoder layers. The overall equations for $l$-th encoder layer are summarized as $\mathcal{X}_{\text {en }}^{l}=\operatorname{Encoder}\left(\mathcal{X}_{\text {en }}^{l-1}\right)$. Details are shown as follows:

$$
\begin{align*}
& \mathcal{S}_{\mathrm{en}}^{l, 1},_{-}=\operatorname{SeriesDecomp}\left(\text { Auto-Correlation }\left(\mathcal{X}_{\mathrm{en}}^{l-1}\right)+\mathcal{X}_{\mathrm{en}}^{l-1}\right) \\
& \mathcal{S}_{\mathrm{en}}^{l, 2},_{-}=\operatorname{Series} \text { Decomp }\left(\operatorname{FeedForward}\left(\mathcal{S}_{\mathrm{en}}^{l, 1}\right)+\mathcal{S}_{\mathrm{en}}^{l, 1}\right), \tag{3}
\end{align*}
$$

where " "" is the eliminated trend part. $\mathcal{X}_{\text {en }}^{l}=\mathcal{S}_{\text {en }}^{l, 2}, l \in\{1, \cdots, N\}$ denotes the output of $l$-th encoder layer and $\mathcal{X}_{\text {en }}^{0}$ is the embedded $\mathcal{X}_{\text {en }} . \mathcal{S}_{\text {en }}^{l, i}, i \in\{1,2\}$ represents the seasonal component after the $i$-th series decomposition block in the $l$-th layer respectively. We will give detailed description of Auto-Correlation $(\cdot)$ in the next section, which can seamlessly replace the self-attention.

- Figure 1: Autoformer architecture. The encoder eliminates the long-term trend-cyclical part by series decomposition blocks (blue blocks) and focuses on seasonal patterns modeling. The decoder accumulates the trend part extracted from hidden variables progressively. The past seasonal information from encoder is utilized by the encoder-decoder Auto-Correlation (center green block in decoder). 

---

Decoder The decoder contains two parts: the accumulation structure for trend-cyclical components and the stacked Auto-Correlation mechanism for seasonal components (Figure 1). Each decoder layer contains the inner Auto-Correlation and encoder-decoder Auto-Correlation, which can refine the prediction and utilize the past seasonal information respectively. Note that the model extracts the potential trend from the intermediate hidden variables during the decoder, allowing Autoformer to progressively refine the trend prediction and eliminate interference information for period-based dependencies discovery in Auto-Correlation. Suppose there are $M$ decoder layers. With the latent variable $\mathcal{X}_{\mathrm{en}}^{N}$ from the encoder, the equations of $l$-th decoder layer can be summarized as $\mathcal{X}_{\mathrm{de}}^{l}=$ $\operatorname{Decoder}\left(\mathcal{X}_{\mathrm{de}}^{l-1}, \mathcal{X}_{\text {en }}^{N}\right)$. The decoder can be formalized as follows:

$$
\begin{align*}
\mathcal{S}_{\mathrm{de}}^{l, 1}, \mathcal{T}_{\mathrm{de}}^{l, 1} & =\operatorname{SeriesDecomp}\left(\text { Auto-Correlation }\left(\mathcal{X}_{\mathrm{de}}^{l-1}\right)+\mathcal{X}_{\mathrm{de}}^{l-1}\right) \\
\mathcal{S}_{\mathrm{de}}^{l, 2}, \mathcal{T}_{\mathrm{de}}^{l, 2} & =\operatorname{SeriesDecomp}\left(\text { Auto-Correlation }\left(\mathcal{S}_{\mathrm{de}}^{l, 1}, \mathcal{X}_{\mathrm{en}}^{N}\right)+\mathcal{S}_{\mathrm{de}}^{l, 1}\right)  \tag{4}\\
\mathcal{S}_{\mathrm{de}}^{l, 3}, \mathcal{T}_{\mathrm{de}}^{l, 3} & =\operatorname{SeriesDecomp}\left(\text { FeedForward }\left(\mathcal{S}_{\mathrm{de}}^{l, 2}\right)+\mathcal{S}_{\mathrm{de}}^{l, 2}\right) \\
\mathcal{T}_{\mathrm{de}}^{l} & =\mathcal{T}_{\mathrm{de}}^{l-1}+\mathcal{W}_{l, 1} * \mathcal{T}_{\mathrm{de}}^{l, 1}+\mathcal{W}_{l, 2} * \mathcal{T}_{\mathrm{de}}^{l, 2}+\mathcal{W}_{l, 3} * \mathcal{T}_{\mathrm{de}}^{l, 3},
\end{align*}
$$

where $\mathcal{X}_{\mathrm{de}}^{l}=\mathcal{S}_{\mathrm{de}}^{l, 3}, l \in\{1, \cdots, M\}$ denotes the output of $l$-th decoder layer. $\mathcal{X}_{\mathrm{de}}^{0}$ is embedded from $\mathcal{X}_{\text {des }}$ for deep transform and $\mathcal{T}_{\text {de }}^{0}=\mathcal{X}_{\text {det }}$ is for accumulation. $\mathcal{S}_{\text {de }}^{l, i}, \mathcal{T}_{\text {de }}^{l, i}, i \in\{1,2,3\}$ represent the seasonal component and trend-cyclical component after the $i$-th series decomposition block in the $l$-th layer respectively. $\mathcal{W}_{l, i}, i \in\{1,2,3\}$ represents the projector for the $i$-th extracted trend $\mathcal{T}_{\text {de }}^{l, i}$. The final prediction is the sum of the two refined decomposed components, as $\mathcal{W}_{\mathcal{S}} * \mathcal{X}_{\mathrm{de}}^{M}+\mathcal{T}_{\mathrm{de}}^{M}$, where $\mathcal{W}_{\mathcal{S}}$ is to project the deep transformed seasonal component $\mathcal{X}_{\mathrm{de}}^{M}$ to the target dimension.

---

Figure 2: Auto-Correlation (left) and Time Delay Aggregation (right). We utilize the Fast Fourier Transform to calculate the autocorrelation $\mathcal{R}(\tau)$, which reflects the time-delay similarities. Then the similar sub-processes are rolled to the same index based on selected delay $\tau$ and aggregated by $\mathcal{R}(\tau)$.

### 3.2 Auto-Correlation Mechanism

As shown in Figure 2, we propose the Auto-Correlation mechanism with series-wise connections to expand the information utilization. Auto-Correlation discovers the period-based dependencies by calculating the series autocorrelation and aggregates similar sub-series by time delay aggregation.

Period-based dependencies It is observed that the same phase position among periods naturally provides similar sub-processes.

Inspired by the stochastic process theory [9, 30], for a real discrete-time process $\left\{\mathcal{X}_{t}\right\}$, we can obtain the autocorrelation $\mathcal{R}_{\mathcal{X} \mathcal{X}}(\tau)$ by the following equations:

$$
\begin{equation*}
\mathcal{R}_{\mathcal{X X}}(\tau)=\lim _{L \rightarrow \infty} \frac{1}{L} \sum_{t=1}^{L} \mathcal{X}_{t} \mathcal{X}_{t-\tau} \tag{5}
\end{equation*}
$$

$\mathcal{R}_{\mathcal{X} \mathcal{X}}(\tau)$ reflects the time-delay similarity between $\left\{\mathcal{X}_{t}\right\}$ and its $\tau$ lag series $\left\{\mathcal{X}_{t-\tau}\right\}$. As shown in Figure 2, we use the autocorrelation $\mathcal{R}(\tau)$ as the unnormalized confidence of estimated period length $\tau$. Then, we choose the most possible $k$ period lengths $\tau_{1}, \cdots, \tau_{k}$. The period-based dependencies are derived by the above estimated periods and can be weighted by the corresponding autocorrelation.

---

Time delay aggregation The period-based dependencies connect the sub-series among estimated periods. Thus, we present the time delay aggregation block (Figure 2), which can roll the series based on selected time delay $\tau_{1}, \cdots, \tau_{k}$. This operation can align similar sub-series that are at the same phase position of estimated periods, which is different from the point-wise dot-product aggregation in self-attention family. Finally, we aggregate the sub-series by softmax normalized confidences.
For the single head situation and time series $\mathcal{X}$ with length- $L$, after the projector, we get query $\mathcal{Q}$, key $\mathcal{K}$ and value $\mathcal{V}$. Thus, it can replace self-attention seamlessly. The Auto-Correlation mechanism is:
$$
\begin{align*}
\tau_{1}, \cdots, \tau_{k} & =\underset{\tau \in\{1, \cdots, L\}}{\arg \operatorname{Topk}}\left(\mathcal{R}_{\mathcal{Q}, \mathcal{K}}(\tau)\right) \\
\widehat{\mathcal{R}}_{\mathcal{Q}, \mathcal{K}}\left(\tau_{1}\right), \cdots, \widehat{\mathcal{R}}_{\mathcal{Q}, \mathcal{K}}\left(\tau_{k}\right) & =\operatorname{SoftMax}\left(\mathcal{R}_{\mathcal{Q}, \mathcal{K}}\left(\tau_{1}\right), \cdots, \mathcal{R}_{\mathcal{Q}, \mathcal{K}}\left(\tau_{k}\right)\right)  \tag{6}\\
\text { Auto-Correlation }(\mathcal{Q}, \mathcal{K}, \mathcal{V}) & =\sum_{i=1}^{k} \operatorname{Roll}\left(\mathcal{V}, \tau_{i}\right) \widehat{\mathcal{R}}_{\mathcal{Q}, \mathcal{K}}\left(\tau_{i}\right)
\end{align*}
$$

where $\arg \operatorname{Topk}(\cdot)$ is to get the arguments of the Topk autocorrelations and let $k=\lfloor c \times \log L\rfloor, c$ is a hyper-parameter. $\mathcal{R}_{\mathcal{Q}, \mathcal{K}}$ is autocorrelation between series $\mathcal{Q}$ and $\mathcal{K}$. $\operatorname{Roll}(\mathcal{X}, \tau)$ represents the operation to $\mathcal{X}$ with time delay $\tau$, during which elements that are shifted beyond the first position are re-introduced at the last position. For the encoder-decoder Auto-Correlation (Figure 1 , $\mathcal{K}, \mathcal{V}$ are from the encoder $\mathcal{X}_{\text {en }}^{N}$ and will be resized to length- $O, \mathcal{Q}$ is from the previous block of the decoder. For the multi-head version used in Autoformer, with hidden variables of $d_{\text {model }}$ channels, $h$ heads, the query, key and value for $i$-th head are $\mathcal{Q}_{i}, \mathcal{K}_{i}, \mathcal{V}_{i} \in \mathbb{R}^{L \times \frac{d_{\text {model }}}{h}}, i \in\{1, \cdots, h\}$. The process is:

$$
\begin{align*}
\operatorname{MultiHead}(\mathcal{Q}, \mathcal{K}, \mathcal{V}) & =\mathcal{W}_{\text {output }} * \operatorname{Concat}\left(\operatorname{head}_{1}, \cdots, \operatorname{head}_{h}\right) \\
\text { where head } & =\text { Auto-Correlation }\left(\mathcal{Q}_{i}, \mathcal{K}_{i}, \mathcal{V}_{i}\right) \tag{7}
\end{align*}
$$

- Figure 3: Auto-Correlation vs. self-attention family. Full Attention [41] (a) adapts the fully connection among all time points. Sparse Attention [23, 48] (b) selects points based on the proposed similarity metrics. LogSparse Attention [26] (c) chooses points following the exponentially increasing intervals. Auto-Correlation (d) focuses on the connections of sub-series among underlying periods.

---

Efficient computation For period-based dependencies, these dependencies point to sub-processes at the same phase position of underlying periods and are inherently sparse. Here, we select the most possible delays to avoid picking the opposite phases. Because we aggregate $\mathcal{O}(\log L)$ series whose length is $L$, the complexity of Equations 6 and 7 is $\mathcal{O}(L \log L)$. For the autocorrelation computation (Equation 5], given time series $\left\{\mathcal{X}_{t}\right\}, \mathcal{R}_{\mathcal{X} \mathcal{X}}(\tau)$ can be calculated by Fast Fourier Transforms (FFT) based on the Wiener-Khinchin theorem [43]:
$$
\begin{align*}
& \mathcal{S}_{\mathcal{X X}}(f)=\mathcal{F}\left(\mathcal{X}_{t}\right) \mathcal{F}^{*}\left(\mathcal{X}_{t}\right)=\int_{-\infty}^{\infty} \mathcal{X}_{t} e^{-i 2 \pi t f} \mathrm{~d} t \overline{\int_{-\infty}^{\infty} \mathcal{X}_{t} e^{-i 2 \pi t f} \mathrm{~d} t}  \tag{8}\\
& \mathcal{R}_{\mathcal{X X}}(\tau)=\mathcal{F}^{-1}\left(\mathcal{S}_{\mathcal{X X}}(f)\right)=\int_{-\infty}^{\infty} \mathcal{S}_{\mathcal{X} \mathcal{X}}(f) e^{i 2 \pi f \tau} \mathrm{~d} f
\end{align*}
$$

where $\tau \in\{1, \cdots, L\}, \mathcal{F}$ denotes the FFT and $\mathcal{F}^{-1}$ is its inverse. $*$ denotes the conjugate operation and $\mathcal{S}_{\mathcal{X X}}(f)$ is in the frequency domain. Note that the series autocorrelation of all lags in $\{1, \cdots, L\}$ can be calculated at once by FFT. Thus, Auto-Correlation achieves the $\mathcal{O}(L \log L)$ complexity.

---

Auto-Correlation vs. self-attention family Different from the point-wise self-attention family, Auto-Correlation presents the series-wise connections (Figure 3). Concretely, for the temporal dependencies, we find the dependencies among sub-series based on the periodicity. In contrast, the self-attention family only calculates the relation between scattered points. Though some selfattentions [26, 48] consider the local information, they only utilize this to help point-wise dependencies discovery. For the information aggregation, we adopt the time delay block to aggregate the similar sub-series from underlying periods. In contrast, self-attentions aggregate the selected points by dot-product. Benefiting from the inherent sparsity and sub-series-level representation aggregation, Auto-Correlation can simultaneously benefit the computation efficiency and information utilization.

## 4 Experiments

We extensively evaluate the proposed Autoformer on six real-world benchmarks, covering five mainstream time series forecasting applications: energy, traffic, economics, weather and disease.

Datasets Here is a description of the six experiment datasets: (1) ETT [48] dataset contains the data collected from electricity transformers, including load and oil temperature that are recorded every 15 minutes between July 2016 and July 2018．（2）Electricity dataset contains the hourly electricity consumption of 321 customers from 2012 to 2014．（3）Exchange［25］records the daily exchange rates of eight different countries ranging from 1990 to 2016．（4）Traffid ${ }^{2}$ is a collection of hourly data from California Department of Transportation，which describes the road occupancy rates measured by different sensors on San Francisco Bay area freeways．（5）Weather ${ }^{3}$ is recorded every 10 minutes for 2020 whole year，which contains 21 meteorological indicators，such as air temperature，humidity， etc．（6）$I L I^{4}$ includes the weekly recorded influenza－like illness（ILI）patients data from Centers for Disease Control and Prevention of the United States between 2002 and 2021，which describes the ratio of patients seen with ILI and the total number of the patients．We follow standard protocol and split all datasets into training，validation and test set in chronological order by the ratio of 6：2：2 for the ETT dataset and 7：1：2 for the other datasets．

---

Implementation details Our method is trained with the L2 loss，using the ADAM［22］optimizer with an initial learning rate of $10^{-4}$ ．Batch size is set to 32 ．The training process is early stopped within 10 epochs．All experiments are repeated three times，implemented in PyTorch［31］and conducted on a single NVIDIA TITAN RTX 24GB GPUs．The hyper－parameter $c$ of Auto－Correlation is in the range of 1 to 3 to trade off performance and efficiency．See Appendix Eand Bfor standard deviations and sensitivity analysis．Autoformer contains 2 encoder layers and 1 decoder layer．

---

Baselines We include 10 baseline methods．For the multivariate setting，we select three latest state－ of－the－art transformer－based models：Informer［48］，Reformer［23］，LogTrans［26］，two RNN－based models：LSTNet［25］，LSTM［17］and CNN－based TCN［4］as baselines．For the univariate setting， we include more competitive baselines：N－BEATS［29］，DeepAR［34］，Prophet［39］and ARMIA［1]．

## 4.1 Main Results

To compare performances under different future horizons，we fix the input length and evaluate models with a wide range of prediction lengths： $96,192,336,720$ ．This setting precisely meets the definition of long－term forecasting．Here are results on both the multivariate and univariate settings．

---

Multivariate results As for the multivariate setting，Autoformer achieves the consistent state－of－ the－art performance in all benchmarks and all prediction length settings（Table 10）．Especially，under the input－96－predict－ 336 setting，compared to previous state－of－the－art results，Autoformer gives $\mathbf{7 4 \%}$ $(1.334 \rightarrow 0.339)$ MSE reduction in ETT， $\mathbf{1 8 \%}(0.280 \rightarrow 0.231)$ in Electricity， $\mathbf{6 1 \%}(1.357 \rightarrow 0.509)$ in Exchange， $\mathbf{1 5 \%}(0.733 \rightarrow 0.622)$ in Traffic and $\mathbf{2 1 \%}(0.455 \rightarrow 0.359)$ in Weather．For the input－ 36－predict－60 setting of ILI，Autoformer makes $\mathbf{4 3 \%}(4.882 \rightarrow 2.770)$ MSE reduction．Overall， Autoformer yields a $\mathbf{3 8 \%}$ averaged MSE reduction among above settings．Note that Autoformer still provides remarkable improvements in the Exchange dataset that is without obvious periodicity．See Appendix Efor detailed showcases．Besides，we can also find that the performance of Autoformer changes quite steadily as the prediction length $O$ increases．It means that Autoformer retains better long－term robustness，which is meaningful for real－world practical applications，such as weather early warning and long－term energy consumption planning．

---

Univariate results We list the univariate results of two typical datasets in Table 2 ．Under the comparison with extensive baselines，our Autoformer still achieves state－of－the－art performance for the long－term forecasting tasks．In particular，for the input－96－predict－336 setting，our model achieves $\mathbf{1 4 \%}(0.180 \rightarrow 0.145)$ MSE reduction on the ETT dataset with obvious periodicity．For the Exchange dataset without obvious periodicity，Autoformer surpasses other baselines by $\mathbf{1 7 \%}(0.611 \rightarrow 0.508)$ and shows greater long－term forecasting capacity．Also，we find that ARIMA［1］performs best in the input－96－predict－96 setting of the Exchange dataset but fails in the long－term setting．This situation of ARIMA can be benefited from its inherent capacity for non－stationary economic data but is limited by the intricate temporal patterns of real－world series．

## 4.2 Ablation studies

Decomposition architecture With our proposed progressive decomposition architecture，other models can gain consistent promotion，especially as the prediction length $O$ increases（Table 3）．This verifies that our method can generalize to other models and release the capacity of other dependencies learning mechanisms, alleviate the distraction caused by intricate patterns. Besides, our architecture outperforms the pre-processing, although the latter employs a bigger model and more parameters. Especially, pre-decomposing may even bring negative effect because it neglects the interaction of components during long-term future, such as Transformer [41] predict-720, Informer [48] predict-336.

- Table 3：Ablation of decomposition in multivariate ETT with MSE metric．Ours adopts our progres－ sive architecture into other models．Sep employs two models to forecast pre－decomposed seasonal and trend－cyclical components separately．Promotion is the MSE reduction compared to Origin．

---

Auto-Correlation vs. self-attention family As shown in Table 4 , our proposed Auto-Correlation achieves the best performance under various input- $I$-predict- $O$ settings, which verifies the effectiveness of series-wise connections comparing to point-wise self-attentions (Figure 3). Furthermore, we can also observe that Auto-Correlation is memory efficiency from the last column of Table 4 , which can be used in long sequence forecasting, such as input-336-predict-1440.

- Table 4: Comparison of Auto-Correlation and self-attention in the multivariate ETT. We replace the Auto-Correlation in Autoformer with different self-attentions. The "-" indicates the out-of-memory.

### 4.3 Model Analysis

Time series decomposition As shown in Figure 4 without our series decomposition block, the forecasting model cannot capture the increasing trend and peaks of the seasonal part. By adding the series decomposition blocks, Autoformer can aggregate and refine the trend-cyclical part from series progressively. This design also facilitates the learning of the seasonal part, especially the peaks and troughs. This verifies the necessity of our proposed progressive decomposition architecture.

- Figure 4: Visualization of learned seasonal $\mathcal{X}_{\text {de }}^{M}$ and trend-cyclical $\mathcal{T}_{\text {de }}^{M}$ of the last decoder layer. We gradually add the decomposition blocks in decoder from left to right. This case is from ETT dataset under input-96-predict-720 setting. For clearness, we add the linear growth to raw data additionally.

---

Dependencies learning The marked time delay sizes in Figure 5 (a) indicate the most likely periods. Our learned periodicity can guide the model to aggregate the sub-series from the same or neighbor phase of periods by $\operatorname{Roll}\left(\mathcal{X}, \tau_{i}\right), i \in\{1, \cdots, 6\}$. For the last time step (declining stage), AutoCorrelation fully utilizes all similar sub-series without omissions or errors compared to self-attentions. This verifies that Autoformer can discover the relevant information more sufficiently and precisely.

- Figure 5: Visualization of learned dependencies. For clearness, we select the top-6 time delay sizes $\tau_{1}, \cdots, \tau_{6}$ of Auto-Correlation and mark them in raw series (red lines). For self-attentions, top-6 similar points with respect to the last time step (red stars) are also marked by orange points.

---

Complex seasonality modeling As shown in Figure 6, the lags that Autoformer learns from deep representations can indicate the real seasonality of raw series. For example, the learned lags of the daily recorded Exchange dataset present the monthly, quarterly and yearly periods (Figure 6(b)). For the hourly recorded Traffic dataset (Figure 6(c)), the learned lags show the intervals as 24-hours and 168-hours, which match the daily and weekly periods of real-world scenarios. These results show that Autoformer can capture the complex seasonalities of real-world series from deep representations and further provide a human-interpretable prediction.

- Figure 6: Statistics of learned lags. For each time series in the test set, we count the top 10 lags learned by decoder for the input-96-predict-336 task. Figure (a)-(d) are the density histograms.

---

Efficiency analysis We compare the running memory and time among Auto-Correlation-based and self-attention-based models (Figure 7) during the training phase. The proposed Autoformer shows $\mathcal{O}(L \log L)$ complexity in both memory and time and achieves better long-term sequences efficiency

- Figure 7: Efficiency Analysis. For memory, we replace Auto-Correlation with self-attention family in Autoformer and record the memory with input 96. For running time, we run the Auto-Correlation or self-attentions $10^{3}$ times to get the execution time per step. The output length increases exponentially.

## 5 Conclusions

This paper studies the long-term forecasting problem of time series, which is a pressing demand for real-world applications. However, the intricate temporal patterns prevent the model from learning reliable dependencies. We propose the Autoformer as a decomposition architecture by embedding the series decomposition block as an inner operator, which can progressively aggregate the longterm trend part from intermediate prediction. Besides, we design an efficient Auto-Correlation mechanism to conduct dependencies discovery and information aggregation at the series level, which contrasts clearly from the previous self-attention family. Autoformer can naturally achieve $\mathcal{O}(L \log L)$ complexity and yield consistent state-of-the-art performance in extensive real-world datasets.

## A Full Benchmark on the ETT Datasets

As shown in Table 5] we build the benchmark on the four ETT datasets [48], which includes the hourly recorded ETTh1 and ETTh2, 15-minutely recorded ETTm1 and ETTm2.

Autoformer achieves sharp improvement over the state-of-the-art on various forecasting horizons. For the input-96-predict-336 long-term setting, Autoformer surpasses previous best results by $\mathbf{5 5 \%}(1.128 \rightarrow 0.505)$ in ETTh $1, \mathbf{8 0 \%}$ ( $2.544 \rightarrow 0.471$ ) in ETTh2. For the input-96-predict-288 long-term setting, Autoformer achieves $\mathbf{4 0 \%}(1.056 \rightarrow 0.634)$ MSE reduction in ETTm1 and $\mathbf{6 6 \%}(0.969 \rightarrow 0.342)$ in ETTm2. These results show a $\mathbf{6 0 \%}$ average MSE reduction over previous state-of-the-art.

Table 5: Multivariate results on the four ETT datasets with predicted length as $\{24,48,168,288,336$, $672,720\}$. We fix the input length of Autoformer as 96 . The experiments of the main text are on the ETTm2 dataset.

## B Hyper-Parameter Sensitivity

As shown in Table 6, we can verify the model robustness with respect to hyper-parameter $c$ (Equation 6 in the main text). To trade-off performance and efficiency, we set $c$ to the range of 1 to 3 . It is also observed that datasets with obvious periodicity tend to have a large factor $c$, such as the ETT and Traffic datasets. For the ILI dataset without obvious periodicity, the larger factor may bring noises.

Table 6: Autoformer performance under different choices of hyper-parameter $c$ in the AutoCorrelation mechanism. We adopt the forecasting setting as input-36-predict-48 for the ILI dataset and input-96-predict-336 for the other datasets.

## C Model Input Selection

## C. 1 Input Length Selection

Because the forecasting horizon is always fixed upon the application's demand, we need to tune the input length in real-world applications. Our study shows that the relationship between input length and model performance is dataset-specific, so we need to select the model input based on the data characteristics. For example, for the ETT dataset with obvious periodicity, an input with length-96 is enough to provide enough information. But for the ILI dataset without obvious periodicity, the model needs longer inputs to discover more informative temporal dependencies. Thus, a longer input will provide a better performance in the ILI dataset.

Table 7: Autoformer performance under different input lengths. We fix the forecasting horizon as 48 for ILI and 336 for the others. The input lengths $I$ of the ILI dataset are in the $\{24,36,48,60\}$. And for the ETT and Exchange datasets, the input lengths $I$ are in the $\{96,192,336,720\}$.

## C. 2 Past Information Utilization

For the decoder input of Autoformer, we attach the length $\frac{I}{2}$ past information to the placeholder. This design is to provide recent past information to the decoder. As shown in Table 8 the model with more past information will obtain a better performance, but it also causes a larger memory cost. Thus, we set the decoder input as $\frac{I}{2}+O$ to trade off both the performance and efficiency.

Table 8: Autoformer performance under different lengths of input of the decoder. $O, \frac{I}{2}+O, I+O$ corresponds to the decoder input without past information, with half past information, with full past information respectively. We fix the forecasting setting as input-96-predict-336 on the ETT dataset.

## D Ablation of Decomposition Architecture

In this section, we attempt to further verify the effectiveness of our proposed progressive decomposition architecture. We adopt more well-established decomposition algorithms as the pre-processing for separate prediction settings. As shown in Table 9 our proposed progressive decomposition architecture consistently outperforms the separate prediction (especially the long-term forecasting setting), despite the latter being with mature decomposition algorithms and twice bigger model.

Table 9: Ablation of decomposition architecture in ETT dataset under the input-96-predict- $O$ setting, where $O \in\{96,192,336,720\}$. The backbone of separate prediction is canonical Transformer [41]. We adopt various decomposition algorithms as the pre-processing and use two Transformers to separately forecast the seasonal and trend-cyclical parts. The result is the sum of two parts prediction.

## E Supplementary of Main Results

## E. 1 Multivariate Showcases

To evaluate the prediction of different models, we plot the last dimension of forecasting results that are from the test set of ETT dataset for qualitative comparison (Figures 8,9 , 10 and 11 ). Our model gives the best performance among different models. Moreover, we observe that Autoformer can accurately predict the periodicity and long-term variation.

Figure 8: Prediction cases from the ETT dataset under the input-96-predict- 96 setting. Blue lines are the ground truth and orange lines are the model prediction. The first part with length 96 is the input.

Figure 9: Prediction cases from the ETT dataset under the input-96-predict-192 setting.

Figure 10: Prediction cases from the ETT dataset under the input-96-predict-336 setting.

Figure 11: Prediction cases from the ETT dataset under the input-96-predict-720 setting.

## E. 2 Performance on Data without Obvious Periodicity

Autoformer yields the best performance among six datasets, even in the Exchange dataset that does not have obvious periodicity. This section will give some showcases from the test set of multivariate Exchange dataset for qualitative evaluation. We observed that the series in the Exchange dataset show rapid fluctuations. And because of the inherent properties of economic data, the series does not present obvious periodicity. This aperiodicity causes extreme difficulties for prediction. As shown in Figure 12, compared to other models, Autoformer can still predict the exact long-term variations. It is verified the robustness of our model performance among various data characteristics.

Figure 12: Prediction cases from the Exchange dataset under the input-96-predict-192 setting.

## E. 3 Univariate Forecasting Showcases

As shown in Figure 13 Autoformer gives the most accurate prediction. Compared to Informer [48], Autoformer can precisely capture the periods of the future horizon. Besides, our model provides better prediction in the center area than LogTrans [26]. Compared with Reformer [23], our prediction series is smooth and closer to ground truth. Also, the fluctuation of DeepAR [34] prediction is getting smaller as prediction length increases and suffers from the over-smoothing problem, which does not happen in our Autoformer.

Figure 13: Prediction cases from the ETT dataset under the input-96-predict-720 univariate setting.

## E. 4 Main Results with Standard Deviations

To get more robust experimental results, we repeat each experiment three times. The results are shown without standard deviations in the main text due to the limited pages. Table 10 shows the standard deviations.

## F COVID-19: Case Study

We also apply our model to the COVID-19 real-world data [15]. This dataset contains the data collected from countries, including the number of confirmed deaths and recovered patients of COVID-19 recorded daily from January 22, 2020, to May 20, 2021. We select two anonymous countries in Europe for the experiments. The data is split into training, validation and test set in chronological order following the ratio of 7:1:2 and normalized. Note that this problem is quite challenging because the training data is limited.

Table 10: Quantitative results with fluctuations under different prediction lengths $O$ for multivariate forecasting. We set the input length $I$ as 36 for ILI and 96 for the other datasets. A lower MSE or MAE indicates a better performance.

## F.1 Quantitative Results

We still follow the long-term forecasting task and let the model predict the next week, half month, full month respectively. The prediction lengths are 1, 2.1, 4.3 times the input length. As shown in Table 11 Autoformer still keeps the state-of-the-art accuracy under the limited data and short input situation.

Table 11: Quantitative results for COVID-19 data. We set the input length $I$ as 7, which means that the data in one week. The prediction length $O$ is in $\{7,15,30\}$, which represents a week, half a month, a month respectively. A lower MSE or MAE indicates a better prediction.

## F.2 Showcases

As shown in Figure 14 compared to other models, our Autoformer can accurately predict the peaks and troughs at the beginning and can almost predict the exact value in the long-term future. The forecasting of extreme values and long-term trends are essential to epidemic prevention and control.

Figure 14: Showcases from the second country of COVID-19 under the input-7-predict-15 setting.

## G Autoformer: Implementation Details

## G. 1 Model Design

We provide the pseudo-code of Autoformer and Auto-Correlation mechanism in Algorithms 1 and 2 respectively. The tensor shapes and hyper-parameter settings are also included. Besides the above standard version, we speed up the Auto-Correlation to a batch-normalization-style block for efficiency, namely speedup version. All the experiment results of this paper are from the speedup version. Here are the implementation details.

---

Speedup version Note that the gather operation in Algorithm 2 is not memory-access friendly. We borrow the design of batch normalization [21] to speedup the Auto-Correlation mechanism. We separate the whole procedure as the training phase and the inference phase. Because of the property of the linear layer, the channels of deep representations are equivalent. Thus, we reduce the channel and head dimension for both the training and inference phases. Especially for the training phase, we average the autocorrelation within a batch to simplify the learned lags. This design speeds up Auto-Correlation and performs as normalization to obtain a global judgment of the learned lags because the series within a batch are samples from the same time-series dataset. The pseudo-code for the training phase is presented in Algorithm 3 For the testing phase, we still use the gather operation with respect to the simplified lags, which is more memory-access friendly than the standard version. The pseudo-code for the inference phase is presented in Algorithm4

---

Complexity analysis Our model provides the series-wise aggregation for $\lfloor c \times \log L\rfloor$ delayed length- $L$ series. Thus, the complexity is $\mathcal{O}(L \log L)$ for both the standard version and the speedup version. However, the latter is faster because it is more memory-access friendly.

## G. 2 Experiment Details

All these transformer-based models are built with two encoder layers and one decoder layer for the sake of the fair comparison in performance and efficiency, including Informer [48], Reformer [23], LogTrans [26] and canonical Transformer [41]. Besides, all these models adopt the embedding method and the one-step generation strategy as Informer [48]. Note that our proposed series-wise aggregation can provide enough sequential information. Thus, we do not employ the position embedding as other baselines but keep the value embedding and time stamp embedding.

## H Broader Impact

Real-world applications Our proposed Autoformer focuses on the long-term time series forecasting problem, which is a valuable and urgent demand in extensive applications. Our method achieves consistent state-of-the-art performance in five real-world applications: energy, traffic, economics, weather and disease. In addition, we provide the case study of the COVID-19 dataset. Thus, people who work in these areas may benefit greatly from our work. We believe that better time series forecasting can help our society make better decisions and prevent risks in advance for various fields.

---

Academic research In this paper, we take the ideas from classic time series analysis and stochastic process theory. We innovate a general deep decomposition architecture with a novel Auto-Correlation mechanism, which is a worthwhile addition to time series forecasting models. Code is available at this repository: https://github.com/thuml/Autoformer.

---

Model Robustness Based on the extensive experiments, we do not find exceptional failure cases. Autoformer even provides good performance and long-term robustness in the Exchange dataset that does not present obvious periodicity. Autoformer can progressively get purer series components by the inner decomposition block and make it easy to discover the deeply hidden periodicity. But if the data is random or with extremely weak temporal coherence, Autoformer and any other models may degenerate because the series is with poor predictability [14].

Our work only focuses on the scientific problem, so there is no potential ethical risk.
