## å®šç†$\textbf{2.1}$çš„å†…å®¹

ğŸ‘‰å‰æ$1$ï¼šè®¾å®š$\forall{}\varepsilon,\delta\text{>}0$(å…¶ä¸­$\varepsilon{}\text{â‰¤}\cfrac{1}{2}$ä¸”$\delta{â‰¤}\varepsilon$)ï¼Œç»™å®šå•ä½å‘é‡é›†$P,Q\text{âŠ†}\mathbb{R}^d$å¹¶æ»¡è¶³$m\text{=}|Q|\text{+}|P|$

ğŸ‘‰å‰æ$2$ï¼šé€‰æ‹©å‚æ•°$k_{\text{sim}}\text{=}O\left(\cfrac{1}{\varepsilon}\log{\left(\cfrac{m}{\delta}\right)}\right)$ï¼Œ$d_{\text{proj}}\text{=}O\left(\cfrac{1}{\varepsilon^2}\log{\left(\cfrac{m}{\varepsilon\delta}\right)}\right)$ï¼Œ$R_{\text{reps}}\text{=}1$

ğŸ‘‰ç»“è®ºï¼š$\text{NChamfer}(Q,P)\text{â€“}\varepsilon\text{â‰¤}\cfrac{1}{|Q|}\left\langle\mathbf{F}_{\text{que}}(Q),\mathbf{F}_{\text{doc}}(P)\right\rangle\text{â‰¤}\text{NChamfer}(Q,P)\text{+}\varepsilon$ä»¥$\text{Pr}\text{â‰¥}1\text{â€“}\delta$æ¦‚ç‡æˆç«‹

## ä¸€äº›è®°å·

ğŸ‘‰è®°$\forall{}x,y\text{âˆˆ}\mathbb{R}^b$å¤¹è§’ä¸º$\theta(x,y)\text{âˆˆ}[0,\pi]$ï¼Œäºæ˜¯æœ‰$\cos(\theta(x,y))\text{=}\cfrac{\langle{}x,y\rangle}{\|x\|\|y\|}$

ğŸ‘‰è®°ç›®æ ‡ç‚¹ä¸º$\displaystyle{}p_i^*\text{=}\arg\max_{p\text{âˆˆ}P}\langle{}q_i,p\rangle{}\text{=}\arg\text{MaxSim}(q_i)$ï¼Œå³$p_i^{*}$ä¸ºä¸$q_i$ä¸€èµ·æ„æˆ$\text{MaxSim}(q_i)$çš„é‚£ä¸ª$p$

ğŸ‘‰è®°æœ€å°è§’ä¸º$\theta_i^*\text{=}\theta(q_i,p_i^*)$ï¼Œå³å–å¾—$\text{MaxSim}(q_i)$æ—¶$q_i$ä¸$p$çš„å¤¹è§’

1. å¹¶ä¸”æ³¨æ„åˆ°$\text{MaxSim}(q_i)$ä»£è¡¨ç€$q_i$å’Œ$p$å†…ç§¯æœ€å¤§ï¼Œå³è§’åº¦æœ€å°$\displaystyle{}\theta_i^*\text{=}\min_{p\text{âˆˆ}P}\theta(q_i,p)$

ğŸ‘‰è®°äºŒè¿›åˆ¶ç¼–ç $x,y$çš„æµ·æ˜è·ç¦»ä¸º$\|xâ€“y\|_{0}$ 

## å·²å¾—åˆ°çš„ç»“è®º

â¡ï¸ç­‰ä»·äºè¯$\text{Pr}\left[f_i\right]\text{â‰¥}1â€“\cfrac{\varepsilon\delta}{|Q|}$ï¼Œå…¶ä¸­äº‹ä»¶$f_i$æŒ‡$\left\langle\mathbf{F}_{\text{que}}(q_i),\mathbf{F}_{\text{doc}}(P)\right\rangle\text{â‰¥}\displaystyle{}\text{MaxSim}(q_i)\text{â€“}\varepsilon$æˆç«‹

â¡ï¸(å¼•ç†$\text{A.4}$çš„ç»“è®º)å¯¹å•ç‹¬çš„$p_j$æœ‰$\left|\|\varphi(q_i)â€“\varphi(p_j)\|_0\text{ â€“ }\cfrac{k_{\mathrm{sim}}\theta(q_i,p_j)}{\pi}\right|\text{<}\sqrt{\varepsilon}k_{\mathrm{sim}}$ï¼Œä»¥$\text{Pr}\text{ï¼}1â€“\left(\cfrac{\varepsilon{}\delta{}}{m^2}\right)$çš„æ¦‚ç‡æˆç«‹

â¡ï¸(å¼•ç†$\text{A.4}$çš„ç»“è®º)å¯¹æ‰€æœ‰$|P|$ä¸ª$p_j$éƒ½æœ‰$\left|\|\varphi(q_i)â€“\varphi(p_j)\|_0\text{ â€“ }\cfrac{k_{\mathrm{sim}}\theta(q_i,p_j)}{\pi}\right|\text{<}\sqrt{\varepsilon}k_{\mathrm{sim}}$ï¼Œä»¥$\text{Pr}\text{â‰¥}1â€“|P|\left(\cfrac{\varepsilon{}\delta{}}{m^2}\right)\text{â‰¥}1â€“\left(\cfrac{\varepsilon{}\delta{}}{m}\right)$çš„æ¦‚ç‡æˆç«‹

## æ— æŠ•å½±æƒ…å½¢çš„åˆ†æ

â¡ï¸$\text{FDE}$çš„å†…ç§¯ä¸º$\displaystyle{}\left\langle\mathbf{F}_{\text{que}}(Q),\mathbf{F}_{\text{doc}}(P)\right\rangle\text{=}\sum_{k\text{=}1}^B\langle{}\vec{q}_{(k)},\vec{p}_{(k)}\rangle{}$ï¼Œå³å°†æ‰€æœ‰æ¡¶ç”Ÿæˆå‘é‡$\vec{q}_{(k)},\vec{p}_{(k)}$çš„å†…ç§¯ç›¸åŠ ï¼Œåˆ†ä¸ºä¸¤éƒ¨åˆ†

1. å¯¹äº$\text{Case-0}$ï¼šè´¡çŒ®äº†$\displaystyle{}\sum_{k\text{=}1}^M\langle{}\vec{q}_{(k)},\vec{p}_{(k)}\rangle{}\text{=}\sum_{k\text{=}1}^M\displaystyle{}\left\langle\sum_{\varphi(q_i)\text{=}k}q_i,\hat{p}_k\right\rangle\text{=}\sum_{k\text{=}1}^M\sum_{\varphi(q_i)\text{=}k}\langle{}q_i,\hat{p}_k\rangle{}$
2. å¯¹äº$\text{Case-n}$ï¼šè´¡çŒ®äº†$\displaystyle{}\sum_{k\text{=}1}^N\langle{}\vec{q}_{(k)},\vec{p}_{(k)}\rangle{}\text{=}\sum_{k\text{=}1}^N\displaystyle{}\left\langle\sum_{\varphi(q_i)\text{=}k}q_i,\sum_{\varphi(p_j)\text{=}k}\frac{1}{\left|P\text{âˆ©}\varphi^{â€“1}(k)\right|}p_j\right\rangle\text{=}\sum_{k\text{=}1}^N\sum_{\varphi(q_i)\text{=}k}\cfrac{1}{\left|P\text{âˆ©}\varphi^{â€“1}(k)\right|}\sum_{\varphi(p_j)\text{=}k}\langle{}q_i,p_j\rangle{}$ 

â¡ï¸ç”±äºè¯¥æ¨¡å‹æ˜¯çº¿æ€§çš„ï¼Œæ‰€ä»¥$\displaystyle{}\mathbf{F}_{\mathrm{que}}(Q)\text{=}\sum_{i}\mathbf{F}_{\mathrm{que}}(q_i)$ï¼Œæ‰€ä»¥$\displaystyle{}\cfrac{1}{|Q|}\left\langle\mathbf{F}_{\text{que}}(Q),\mathbf{F}_{\text{doc}}(P)\right\rangle\text{=}\cfrac{1}{|Q|}\sum_i\left\langle\mathbf{F}_{\text{que}}(q_i),\mathbf{F}_{\text{doc}}(P)\right\rangle$

â¡ï¸å¯¹äº$\left\langle\mathbf{F}_{\text{que}}(q_i),\mathbf{F}_{\text{doc}}(P)\right\rangle$è€Œè¨€

1. å½“æ‰€æœ‰$q_i$è½å…¥çš„æ¡¶å±äº$\text{Case-0}$æƒ…å½¢æ—¶ï¼Œ$\left\langle\mathbf{F}_{\text{que}}(q_i),\mathbf{F}_{\text{doc}}(P)\right\rangle\text{=}\langle{}q_i,\hat{p}_k\rangle{}$
2. å½“æ‰€æœ‰$q_i$è½å…¥çš„æ¡¶å±äº$\text{Case-n}$æƒ…å½¢æ—¶ï¼Œ$\displaystyle\left\langle\mathbf{F}_{\text{que}}(q_i),\mathbf{F}_{\text{doc}}(P)\right\rangle\text{=}\cfrac{1}{\left|P\text{âˆ©}\varphi^{â€“1}(k)\right|}\sum_{\varphi(p_j)\text{=}k}\langle{}q_i,p_j\rangle{}$  

â¡ï¸æ— æŠ•å½±æ—¶æ€»å­˜åœ¨ä¸€ä¸ªå­é›†$S\text{âŠ†}P$ï¼Œä½¿å¾—$\displaystyle\left\langle\mathbf{F}_{\text{que}}(q_i),\mathbf{F}_{\text{doc}}(P)\right\rangle\text{=}\left\langle{}q_i,\frac{1}{|S|}\sum_{p_j\text{âˆˆ}S}p_j\right\rangle{}$ï¼Œå¹¶ä¸”åˆ†ä¸ºä¸¤ç§æƒ…å†µ

1. å½“å•ä¸ª$q_i$è½å…¥çš„æ¡¶å±äº$\text{Case-0}$æƒ…å½¢æ—¶ï¼Œ$S$æ˜¯å•ä¸ªç‚¹$\displaystyle{}\hat{p}_k\text{=}\arg{}\min_{p_j\text{âˆˆ}P}\|\varphi(q_i)â€“\varphi(p_j)\|_{0}$ï¼Œä¹Ÿå°±æ˜¯ç¦»æ¡¶ç¼–ç $\varphi(q_i)$æµ·æ˜è·ç¦»æœ€è¿‘çš„ç‚¹
2. å½“å•ä¸ª$q_i$è½å…¥çš„æ¡¶å±äº$\text{Case-n}$æƒ…å½¢æ—¶ï¼Œ$S$å…ƒç´ éœ€æ»¡è¶³$\varphi(q_i)\text{=}\varphi(p_j)$ 

## å¯¹$\textbf{Case-0}$(æ— æŠ•å½±)çš„åˆ†æ

â¡ï¸å‡è®¾$q_i$è½å…¥äº†ç©ºæ¡¶$k$ï¼Œç©ºæ¡¶$k$æœ€è¿‘çš„æ®µè½ç‚¹æ˜¯$\hat{p}_k$ï¼Œæ‰€ä»¥å¯ä»¤$S\text{=}\{\hat{p}_k\}\text{âŠ†}P$éšä¹‹æœ‰$\displaystyle\left\langle\mathbf{F}_{\text{que}}(q_i),\mathbf{F}_{\text{doc}}(P)\right\rangle\text{=}\left\langle{}q_i,\hat{p}_k\right\rangle{}$å³ç²¾ç¡®æˆç«‹

â¡ï¸å¦‚æœ$\hat{p}_k\text{=}p_i^*$ï¼Œå³åˆšå¥½$\displaystyle{}\langle{}q_i,\hat{p}_k\rangle{}\text{=}\text{MaxSim}(q_i)$ï¼Œé‚£ä¹ˆ$\left\langle\mathbf{F}_{\text{que}}(q_i),\mathbf{F}_{\text{doc}}(P)\right\rangle\text{=}\langle{}q_i,\hat{p}_k\rangle{}\text{=}\text{MaxSim}(q_i)$ï¼ŒåŸå¼å¾—è¯

â¡ï¸å¦‚æœ$\hat{p}_k\text{â‰ }p_i^*$ï¼Œåº”ç”¨å¼•ç†$\text{A.4}$çš„ç»“è®ºæœ‰$\begin{cases}\left|\cfrac{\|\varphi(q_i)â€“\varphi(\hat{p}_k)\|_0}{k_{\mathrm{sim}}}\text{ â€“ }\cfrac{\theta(q_i,\hat{p}_k)}{\pi}\right|\text{<}\sqrt{\varepsilon}\\\\\left|\cfrac{\|\varphi(q_i)â€“\varphi(p_i^*)\|_0}{k_{\mathrm{sim}}}\text{ â€“ }\cfrac{\theta(q_i,p_i^*)}{\pi}\right|\text{<}\sqrt{\varepsilon}\end{cases}$äºŒè€…éƒ½ä»¥$\text{Pr}\text{ï¼}1â€“\left(\cfrac{\varepsilon{}\delta{}}{m^2}\right)$çš„æ¦‚ç‡æˆç«‹

1. é‰´äº$\text{Muvera}$å¡«å……ç©ºæ¡¶çš„ç­–ç•¥ï¼Œæ˜¾ç„¶æœ‰$\cfrac{\|\varphi(q_i)â€“\varphi(\hat{p}_k)\|_0}{k_{\mathrm{sim}}}\text{<}\cfrac{\|\varphi(q_i)â€“\varphi(p_i^*)\|_0}{k_{\mathrm{sim}}}$
2. ä»£å…¥åŸç»“è®ºåˆ™æœ‰$\cfrac{\theta(q_i,\hat{p}_k)}{\pi}â€“\sqrt{\varepsilon}\text{â‰¤}\cfrac{\|\varphi(q_i)â€“\varphi(\hat{p}_k)\|_0}{k_{\mathrm{sim}}}\text{<}\cfrac{\|\varphi(q_i)â€“\varphi(p_i^*)\|_0}{k_{\mathrm{sim}}}\text{â‰¤}\cfrac{\theta(q_i,p_i^*)}{\pi}\text{+}\sqrt{\varepsilon}$ï¼Œå³$\left|\theta(q_i,\hat{p}_k)â€“\theta(q_i,p_i^*)\right|\text{<}2{\pi}\sqrt{\varepsilon}$ 
3. å› æ­¤$\left|\theta(q_i,\hat{p}_k)â€“\theta(q_i,p_i^*)\right|\text{=}O\left(\sqrt{\varepsilon}\right)$ 

â¡ï¸ä»¤$\begin{cases}\theta_1\text{=}\theta(q_i,\hat{p}_k)\\\\\theta_2\text{=}\theta(q_i,p_i^*)\end{cases}$ä»¥åŠ$\Delta\theta\text{=}\theta_1â€“\theta_2$ï¼Œå¹¶ä¸”ä¸å¦¨å‡å®š$\Delta\theta\text{=}2{\pi}\sqrt{\varepsilon}\text{>0}$ 

1. ç”±äº$\cos\theta_1\text{=}\cos\left(\theta_2\text{+}\Delta \theta\right)\text{=}\cos\theta_2 \cos \Delta\thetaâ€“\sin\theta_2\sin\Delta\theta$ï¼Œæ‰€ä»¥$\cos\theta_1â€“\cos\theta_2\text{=}\cos\theta_2(\cos \Delta\thetaâ€“1)â€“\sin\theta_2\sin\Delta\theta$ 
2. æ•…$\left|\cos\theta_1â€“\cos\theta_2\right|\text{=}\left|\cos\theta_2(\cos\Delta\thetaâ€“1)â€“\sin\theta_2\sin\Delta\theta\right|\text{â‰¤}\left|\cos\theta_2(\cos\Delta\thetaâ€“1)\right|\text{+}\left|\sin\theta_2\sin\Delta\theta\right|$ 
3. å…¶ä¸­$\left|\cos\theta_2(\cos\Delta\thetaâ€“1)\right|\text{â‰¤}\left|\cos\Delta\thetaâ€“1\right|\text{â‰¤}\left|1â€“\cfrac{\Delta\theta^2}{2}â€“1\right|\text{=}\left|\cfrac{\Delta\theta^2}{2}\right|$ï¼Œä»¥åŠ$\left|\sin\theta_2\sin\Delta\theta\right|\text{â‰¤}\left|\sin\Delta\theta\right|\text{â‰¤}\left|\Delta\theta\right|$
4. ä»£å›$\left|\cos\theta_1â€“\cos\theta_2\right|\text{â‰¤}\left|\cfrac{\Delta\theta^2}{2}\right|\text{+}\left|\Delta\theta\right|\text{=}2\pi^2\varepsilon\text{+}2\pi\sqrt{\varepsilon}$ï¼Œå› æ­¤$\left|\cos\theta_1â€“\cos\theta_2\right|\text{â‰¤}O(\varepsilon)$  

â¡ï¸å› æ­¤$\left\langle\mathbf{F}_{\text{que}}(q_i),\mathbf{F}_{\text{doc}}(P)\right\rangle\text{=}\left\langle{}q_i,\hat{p}_k\right\rangle\text{=}\cos\theta_1\text{â‰¥}\cos\theta_2â€“O(\varepsilon)\text{=}\left\langle{}q_i,p_i^*\right\rangleâ€“O(\varepsilon)\text{=}\text{MaxSim}(q_i)â€“O(\varepsilon)$

â¡ï¸å³$\left\langle\mathbf{F}_{\text{que}}(q_i),\mathbf{F}_{\text{doc}}(P)\right\rangle\text{â‰¥}\text{MaxSim}(q_i)â€“O(\varepsilon)$ä»¥$\text{Pr}\text{ï¼}1â€“\cfrac{\varepsilon{}\delta{}}{m^2}\text{>}1â€“\cfrac{\varepsilon\delta}{|Q|}$çš„æ¦‚ç‡æˆç«‹ï¼Œå†å°†$\varepsilon$è¿›è¡Œå¸¸æ•°å› å­è°ƒæ•´å³è¯æ¯•

## å¯¹$\textbf{Case-n}$(æ— æŠ•å½±)çš„åˆ†æ

â¡ï¸å‡è®¾$q_i$è½å…¥äº†éç©ºæ¡¶$k$ï¼Œ$S$å°±æ˜¯æ¡¶å†…æ‰€æœ‰çš„æ®µè½å‘é‡$p_j$ï¼Œå³$S\text{=}\left\{p_j\text{âˆˆ}P^{\prime}|\boldsymbol{\varphi}(q_i)\text{=}\varphi(p_j)\right\}$

â¡ï¸åº”ç”¨å¼•ç†$\text{A.4}$åˆ™æœ‰

1. å¯¹æ‰€æœ‰$|S|$ä¸ª$p_j$éƒ½æœ‰$\left|\|\varphi(q_i)â€“\varphi(p_j)\|_0\text{ â€“ }\cfrac{k_{\mathrm{sim}}\theta(q_i,p_j)}{\pi}\right|\text{<}\sqrt{\varepsilon}k_{\mathrm{sim}}$ï¼Œä»¥$\text{Pr}\text{â‰¥}1â€“|S|\left(\cfrac{\varepsilon{}\delta{}}{m^2}\right)\text{>}1â€“\left(\cfrac{\varepsilon{}\delta{}}{m}\right)$çš„æ¦‚ç‡æˆç«‹ 
2. è€ƒè™‘åˆ°$\|\varphi(q_i)â€“\varphi(p_j)\|_0\text{=}0$ï¼Œæ•…å˜ä¸ºå¯¹æ‰€æœ‰$|S|$ä¸ª$p_j$éƒ½æœ‰$\left|\theta(q_i,p_j)\right|\text{<}\pi\sqrt{\varepsilon}$ï¼Œä»¥$\text{Pr}\text{>}1â€“\cfrac{\varepsilon{}\delta{}}{m}$çš„æ¦‚ç‡æˆç«‹ 

â¡ï¸å‡è®¾åœ¨$p_i^*$å¤„å–å¾—$\text{MaxSim}(q_i,p_i^*)$ï¼Œäºæ˜¯åŒä¸Šç†å¯è¯$\left|\cos\theta(q_i,p_j)â€“\cos\theta(q_i,p_i^*)\right|\text{â‰¤}O(\varepsilon)$ï¼Œå³$\langle{}q_i,p_j\rangle\text{â‰¥}\langle{}q_i,p_i^*\rangleâ€“O(\varepsilon)$

â¡ï¸ä»£å›$\displaystyle\left\langle\mathbf{F}_{\text{que}}(q_i),\mathbf{F}_{\text{doc}}(P)\right\rangle\text{=}\left\langle{}q_i,\cfrac{1}{|S|}\sum_{p_j\text{âˆˆ}S}p_j\right\rangle{}\text{=}\cfrac{1}{|S|}\sum_{p_j\text{âˆˆ}S}\langle{}q_i,p_j\rangle\text{â‰¥}\cfrac{1}{|S|}\sum_{p_j\text{âˆˆ}S}(\langle{}q_i,p_i^*\rangleâ€“O(\varepsilon))\text{=}\langle{}q_i,p_i^*\rangleâ€“O(\varepsilon)\text{=MaxSim}(q_i)â€“O(\varepsilon)$  

â¡ï¸å³$\displaystyle\left\langle\mathbf{F}_{\text{que}}(q_i),\mathbf{F}_{\text{doc}}(P)\right\rangle\text{â‰¥MaxSim}(q_i)â€“O(\varepsilon)$ä»¥$\text{Pr}\text{>}1â€“\cfrac{\varepsilon{}\delta{}}{m}\text{>}1â€“\cfrac{\varepsilon\delta}{|Q|}$çš„æ¦‚ç‡æˆç«‹ï¼Œå†å°†$\varepsilon$è¿›è¡Œå¸¸æ•°å› å­è°ƒæ•´å³è¯æ¯•

## å¯¹äºè¯¯å·®æœŸæœ›çš„åˆ†æ

$\begin{array}{|c|l|l|}
\hline
äº‹ä»¶ & æ¦‚ç‡ & \textbf{FDE}ä¸\textbf{MaxSim}çš„è¯¯å·® \\
\hline
è¯¯å·®ä¸‹ç•Œæˆç«‹ & \text{N/A} & \text{Err}_1\text{=}O(\varepsilon) \\
\hline
è¯¯å·®ä¸‹ç•Œä¸æˆç«‹ & \text{Pr}_2\text{<}\cfrac{\varepsilon{}\delta{}}{|Q|}å³\text{Pr}_2\text{=}O\left(\cfrac{\varepsilon{}\delta{}}{m}\right)\text{=}O\left(\varepsilon{}\delta{}\right) & \text{Err}_2\text{â‰¤}2\left|\langle\mathbf{F}_{\text{que}}(q_i),\mathbf{F}_{\text{doc}}(P)\right\rangle|\text{â‰¤}2 \\
\hline
\end{array}$ 

â¡ï¸æ‰€ä»¥$\mathbb{E}[\text{Err}]\text{=}\text{Pr}_1O(\varepsilon)\text{+}2O\left(\varepsilon{}\delta{}\right)\text{â‰¤}O(\varepsilon)\text{+}2O\left(\varepsilon{}\delta{}\right)$ ï¼Œå³å¤±è´¥æƒ…å†µä¸‹æœ€å¤šå†å¼•å…¥$O(\varepsilon\delta)$å¤§å°çš„è¯¯å·®ï¼Œå‡ ä¹å¯ä»¥å¿½ç•¥

â¡ï¸ä½æ¦‚ç‡å¤±è´¥äº‹ä»¶çš„å½±å“è¢«ä¸¥æ ¼æ§åˆ¶

