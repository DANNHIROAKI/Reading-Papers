# 0. Abstract

神经信息检索（IR）极大地推动了搜索和其他知识密集型语言任务的发展。虽然许多神经IR方法将查询和文档编码为单一向量表示，但后期交互模型在每个标记的粒度上生成多向量表示，并将相关性建模分解为可扩展的标记级计算。研究表明，这种分解使得后期交互更加有效，但也使这些模型的空间占用增加了一个数量级。在本研究中，我们引入了ColBERTv2，一种结合了激进的残差压缩机制和降噪监督策略的检索模型，旨在同时提高后期交互的质量和空间占用。我们在广泛的基准测试中评估了ColBERTv2，证明其在训练域内外均达到了最新的质量水平，同时将后期交互模型的空间占用减少了6至10倍。

# 1. Intro

神经信息检索（IR）在过去的$2-3$年间迅速主导了搜索领域，不仅极大地推动了段落和文档搜索的发展（Nogueira 和 Cho，2019），还在许多知识密集型的自然语言处理任务中取得了显著进展，例如开放域问答（Guu等，2020）、多跳声明验证（Khattab等，2021a）以及开放式生成（Paranjape等，2022）。

---

许多神经IR方法遵循单向量相似性范式：使用预训练的语言模型将每个查询和文档编码为一个高维向量，并通过两者之间的简单点积来建模相关性。另一种方法是ColBERT（Khattab和Zaharia，2020）中提出的后期交互，其中查询和文档被编码为细粒度的多向量表示，并通过这两组向量之间丰富而可扩展的交互来估计相关性。ColBERT为查询（和文档）中的每个标记生成一个嵌入，并将相关性建模为每个查询向量与文档中所有向量之间最大相似度的总和。

---

通过将相关性建模分解为标记级计算，后期交互旨在减轻编码器的负担：单向量模型必须通过一个点积捕捉复杂的查询-文档关系，而后期交互则在标记级编码含义，并将查询-文档匹配交给交互机制。这种增加的表达能力是有代价的：现有的后期交互系统的空间占用比单向量模型大一个数量级，因为它们必须为网络规模的集合存储数十亿个小向量。考虑到这一挑战，似乎更有成效的方式是通过引入新的负样本挖掘（Xiong等人，2020）、预训练（Gao和Callan，2021）和蒸馏（Qu等人，2021）监督范式，来解决单向量模型的脆弱性（Menon等人，2022）。确实，最近的单向量模型在高度调优的监督策略下（Ren等人，2021b；Formal等人，2021a）有时表现与“原生”后期交互模型相当，甚至更好，而且后期交互架构——由于其固有的标记级归纳偏差——是否能从改进的监督中获得类似的大幅提升，也并不明确。

---

在本研究中，我们展示了后期交互检索器能够自然地生成轻量级的标记表示，这些表示可以直接高效存储，并且能够极大地受益于降噪监督。我们在ColBERTv2中结合了这些特点。ColBERTv2 ${ }^1$ 是一种新的后期交互检索器，采用了来自交叉编码器的简单蒸馏方法和强负样本挖掘 (§3.2)，在提升质量上超越了任何现有方法，然后利用残差压缩机制 (§3.3) 将后期交互的空间占用减少了6-10倍，同时保持了质量。因此，ColBERTv2在训练域内外都建立了最先进的检索质量，并在空间占用方面与典型的单向量模型相当。

---

在MS MARCO Passage Ranking数据集上训练时，ColBERTv2实现了所有独立检索器中最高的MRR@10。除了在域内的高质量表现外，我们还寻求一种能够“零样本”泛化到特定领域语料库和长尾主题的检索器，这些主题往往在大型公共训练集中代表性不足。为此，我们在大量域外基准测试上评估了ColBERTv2，这些基准包括三个Wikipedia开放问答检索测试以及来自BEIR (Thakur et al., 2021) 的13个多样化的检索和语义相似性任务。此外，我们引入了一个新的基准，称为LoTTE，用于长尾主题分层评估，包含12个特定领域的搜索测试，覆盖了StackExchange社区并使用了GooAQ (Khashabi et al., 2021)中的查询。与开放问答测试和许多BEIR任务不同，LoTTE在其段落中专注于相对长尾的主题，并评估模型回答具有实际意图的自然搜索查询的能力，而非BEIR的许多语义相似性任务。在28个域外测试中的22个上，ColBERTv2达到了最高质量表现，其相对增益超过了第二最佳检索器达8%，并使用了压缩后的表示。

---

本研究的主要贡献如下：

1. 我们提出了ColBERTv2，这是一种结合了==降噪监督==和==残差压缩==的检索模型，利用后期交互的标记级分解，在减少空间占用的同时实现了高鲁棒性。

2. 我们引入了LoTTE，一种用于域外检索器评估的新资源。LoTTE专注于围绕长尾主题的自然信息查询，这是一个重要但尚未被充分研究的应用领域。

3. 我们在广泛的环境中评估了ColBERTv2，确立了其在训练域内外的最先进质量水平。